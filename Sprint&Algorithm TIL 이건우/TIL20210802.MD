# TIL 2021 - 08 - 02  📖 !

- sprint

HTTP와 Hashing, Salt그리고 cookie에 대해 배우고 스프린트로 실습 해보았습니다 

- Achievement Goals

1. HTTPS의 개념을 이해할 수 있다.
- 우선적으로 HTTP에 대해 알아야 한다 HTTP 란 Hyper Text Transfer Protocol 의 약자로써 하이퍼텍스트를 전송하기위해 사용되는 통신규약이다. 즉 인터넷에서 HTML과 같은 문서를 사용자 컴퓨터에 설치된 웹 브라우저가 웹서버 요청할 때의 규칙이라고 할 수 있다.
HTTP서버는 기본 포트인 80번 포트에서 서비스 대기중이며, 클라이언트가 TCP80포트를 사용해 연결하면 서버는 요청에 응답하면서 자료를 전송한다. HTTP는 정보를 텍스트로 주고 받기 때문에 네트워크에서 전송 신호를 인터셉트 하는 경우 원하지 않는 데이터 유출이 발생 할 수 있습니다 이러한 보안 취약점을 해결 하기 위해 . HTTP에 S(Secure)가 추가된 HTTPS 입니다. 
- 그렇다면 HTTPS 는 무엇인가 우선 HTTP와 골격은 동일 하지만 보안요소가 추가되었다는 것이 가장 큰 차이점이다 HTTPS를 사용하면 서버와 클라이언트 사이의 모든 통신 내용이 암호화 된다. 
HETTPS는 페이지를 암호화한 키가 그 페이지를 보는 특정 사용자에게만 알려지도록 한다 . HTTPS 는 SSL 이나 TLS 프로토콜을 통해 세션데이터를 암호화 하여 기본 TCP/IP포트는 443이고 , SSL 프로토콜 위에서 HTTPS 프로토콜이 동작한다 . 
[출처](https://eun-jeong.tistory.com/27)
2. HTTPS가 왜 인증에서 필요하고, 왜 사용해야 하는지 이해할 수 있다.
- HTTPS와 SSL를 같은 의미로 이해하고 있는 경우가 많다. 이것은 맞기도 틀리기도 하다. 그것은 마치 인터넷과 웹을 같은 의미로 이해하는 것과 같다. 결론적으로 말하면 웹이 인터넷 위에서 돌아가는 서비스 중의 하나인 것처럼 HTTPS도 SSL 프로토콜 위에서 돌아가는 프로토콜이다.
- 같은 말이다. 네스케이프에 의해서 SSL이 발명되었고, 이것이 점차 폭넓게 사용되다가 표준화 기구인 IETF의 관리로 변경되면서 TLS라는 이름으로 바뀌었다. TLS 1.0은 SSL 3.0을 계승한다. 하지만 TLS라는 이름보다 SSL이라는 이름이 훨씬 많이 사용되고 있다.
- SSL 인증서는 클라이언트와 서버간의 통신을 제3자가 보증해주는 전자화된 문서다. 클라이언트가 서버에 접속한 직후에 서버는 클라이언트에게 이 인증서 정보를 전달한다. 클라이언트는 이 인증서 정보가 신뢰할 수 있는 것인지를 검증 한 후에 다음 절차를 수행하게 된다. SSL과 SSL 디지털 인증서를 이용했을 때의 이점은 아래와 같다.
통신 내용이 공격자에게 노출되는 것을 막을 수 있다. 
클라이언트가 접속하려는 서버가 신뢰 할 수 있는 서버인지를 판단할 수 있다.
통신 내용의 악의적인 변경을 방지할 수 있다. 

[출처](https://www.opentutorials.org/course/228/4894)

3. 세션의 개념을 이해할 수 있다.
- 세션이란?

세션은 쿠키를 기반하고 있지만, 사용자 정보 파일을 브라우저에 저장하는 쿠키와 달리 세션은 서버 측에서 관리합니다.

서버에서는 클라이언트를 구분하기 위해 세션 ID를 부여하며 웹 브라우저가 서버에 접속해서 브라우저를 종료할 때까지 인증상태를 유지합니다.

물론 접속 시간에 제한을 두어 일정 시간 응답이 없다면 정보가 유지되지 않게 설정이 가능 합니다.

사용자에 대한 정보를 서버에 두기 때문에 쿠키보다 보안에 좋지만, 사용자가 많아질수록 서버 메모리를 많이 차지하게 됩니다.

즉 동접자 수가 많은 웹 사이트인 경우 서버에 과부하를 주게 되므로 성능 저하의 요인이 됩니다.

클라이언트가 Request를 보내면, 해당 서버의 엔진이 클라이언트에게 유일한 ID를 부여하는 데 이것이 세션ID다.


- 세션의 프로세스 
 클라이언트가 서버에 접속시 서버가 클라이언트에게 세션 ID를 발급

 서버에서는 클라이언트로 발급해준 세션 ID를 쿠키를 사용해 저장 (JSESSIONID)

 클라이언트는 다시 접속할 때, 이 쿠키(JSESSIONID)를 이용해서 세션ID값을 서버에 전달

4. 쿠키와 세션은 서로 어떤 관계이며, 각각이 인증에 있어서 어떤 목적으로 존재하는지 이해할 수 있다.

- 쿠키란 ?

 쿠키는 클라이언트에 저장되는 키와 값이 들어있는 데이터 파일이다.

 쿠키에는 이름, 값, 만료날짜(쿠키 저장기간), 경로 정보가 들어있으며 일정시간동안 데이터를 저장할 수 있다. (로그인 상태 유지 등에 활용)

 쿠키는 클라이언트의 상태 정보를 로컬(클라이언트의 PC)에 저장했다가 참조한다

 클라이언트에 300개까지 쿠키저장 가능, 하나의 도메인당 20개의 값만 가질 수 있음, 하나의 쿠키값은 4KB까지 저장합니다.

 Response Header에 Set-Cookie 속성을 사용하면 클라이언트에 쿠키를 만들 수 있습니다.

 쿠키는 사용자가 따로 요청하지 않아도 브라우저가 Request시에 Request Header를 넣어서 자동으로 서버에 전송합니다.

 - 쿠키의 구성 요소

 이름 : 각각의 쿠키를 구별하는 데 사용되는 이름

 값 : 쿠키의 이름과 관련된 값

 유효시간 : 쿠키의 유지시간

 도메인 : 쿠키를 전송할 도메인

 경로 : 쿠키를 전송할 요청 경


[출처](https://interconnection.tistory.com/74 )


 - 쿠키의 프로세스 

 클라이언트가 페이지를 요청
 서버에서 쿠키를 생성

 HTTP 헤더에 쿠키를 포함 시켜 응답
 브라우저가 종료되어도 쿠키 만료 기간이 있다면 클라이언트에서 보관하고 있음

 같은 요청을 할 경우 HTTP 헤더에 쿠키를 함께 보냄

 서버에서 쿠키를 읽어 이전 상태 정보를 변경 할 필요가 있을 때 쿠키를 업데이트 하여 변경된 쿠키를 HTTP 헤더에 포함시켜 응답

- 쿠키의 사용 예

 방문 사이트에서 로그인 시, "아이디와 비밀번호를 저장하시겠습니까?"
 쇼핑몰의 장바구니 기능
 자동로그인, 팝업에서 "오늘 더 이상 이 창을 보지 않음" 체크, 쇼핑몰의 장바구니

 - 쿠키와 세션을 사용하는 이유 ?

  HTTP 프로토콜의 특징이자 약점인 connectionless,stateless를 보완하기 위해 사용한다.

  - 세션과 쿠키의 차이점?
  쿠키와 세션은 비슷한 역할을 하며, 동작원리도 비슷합니다. 그 이유는 세션도 결국 쿠키를 사용하기 때문입니다.

 가장 큰 차이점은 사용자의 정보가 저장되는 위치입니다. 때문에 쿠키는 서버의 자원을 전혀 사용하지 않으며, 세션은 서버의 자원을 사용합니다.

 보안 면에서 세션이 더 우수하며, 요청 속도는 쿠키가 세션보다 더 빠릅니다. 그 이유는 세션은 서버의 처리가 필요하기 때문입니다.

 보안, 쿠키는 클라이언트 로컬에 저장되기 때문에 변질되거나 request에서 스니핑 당할 우려가 있어서 보안에 취약하지만 세션은 쿠키를 이용해서 sessionid 만 저장하고 그것으로 구분해서 서버에서 처리하기 때문에 비교적 보안성이 좋습니다.

 라이프 사이클, 쿠키도 만료시간이 있지만 파일로 저장되기 때문에 브라우저를 종료해도 계속해서 정보가 남아 있을 수 있다. 또한 만료기간을 넉넉하게 잡아두면 쿠키삭제를 할 때 까지 유지될 수도 있다.

 반면에 세션도 만료시간을 정할 수 있지만 브라우저가 종료되면 만료시간에 상관없이 삭제된다.

 속도, 쿠키에 정보가 있기 때문에 서버에 요청시 속도가 빠르고 세션은 정보가 서버에 있기 때문에 처리가 요구되어 비교적 느린 속도를 낸다.


[출처](https://interconnection.tistory.com/74)

5. 세션의 한계를 이해할 수 있다.
- 세션은 서버의 자원을 사용하기때문에 무분별하게 만들다보면 서버의 메모리가 감당할 수 없어질 수가 있고 속도가 느려질 수 있기 때문이다.

- 쿠키역시 만료시간이 있지만, 파일로 저장되기 때문에 브라우저를 종료해도 계속해서 정보가 남아 있을 수 있다.
하지만, 세션은 만료시간을 정할 수 있음에도 불구하고 브라우저가 종료되면 만료시간에 상관없이 자동으로 삭제가 된다

- 서버 확장성 문제 :
서비스가 커진다면, 세션을 통한 방법은 서버에 과부하를 줘서 성능을 떨어트리고 서버 확장에 큰 어려움을 가져올 수 있다.
때문에 세션을 이용하기 위해서는 부하 분산으로 DNS나 L4와 같은 로드밸런서를 사용해 줘야 한다.
아니면, 토큰 기반 시스템을 통해 Stateless한 서버를 구축하는 방법이 있다.

- CORS (Cross-Origin Resource Sharing)문제 :
쿠키는 단일 도메인 및 서브 도메인에서만 작동하도록 되어있으므로, 쿠키를 여러 도메인에서 관리하는데 어려움이 있다.