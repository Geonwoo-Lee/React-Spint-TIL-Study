# TIL 2021 - 07 - 23 ðŸ“– !
- ì˜¤ëŠ˜ì€ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ cmarket ë°ì´í„°ë² ì´ìŠ¤ì™€ ì„œë²„ì— ì—°ê²°í•´ì„œ ìš”ì²­ í›„ì— ë°˜í™˜í•˜ëŠ” ê²ƒì„ í•™ìŠµí•´ ë³´ì•˜ìŠµë‹ˆë‹¤ .


ì•„ëž˜ì—ëŠ” post ìš”ì²­ì´ ì™”ì„ ë•Œ ì‘ë‹µí•˜ëŠ” db.query ë¬¸ìž…ë‹ˆë‹¤ 
```js
    post: (userId, orders, totalPrice, callback) => {
      // values ì•ˆì— (${userId})ê°™ì€ í˜•ì‹ìœ¼ë¡œ ì•ˆë„£ì–´ì£¼ëŠ” ì´ìœ ëŠ” ë³´ì•ˆìƒì˜ ì´ìœ  whereì¼ ê²½ìš°ì—ë„ ë™ì¼
      // 
      const sOrders = `INSERT INTO orders(user_id, total_price) VALUES (?,?)`//?ë¡œ ë³€ìˆ˜ë¡œ ì§€ì •ì„ í•´ì£¼ê³  ê°’ì€ db.queryë¬¸ì—ì„œ ë„£ì–´ì¤ë‹ˆë‹¤
      // ì£¼ë¬¸í•˜ëŠ” ì‚¬ëžŒì´, ëˆì„ ë‚¸ë‹¤.
      // ê·¸ëŸ°ë° ê·¸ê°’ì´ ì—†ë‹¤ë©´ ì¦‰ ì£¼ë¬¸ì„í•˜ëŠ”ë° ëˆì„ ì•ˆë‚¸ë‹¤ë©´? ì—ëŸ¬ë¥¼ ì¶œë ¥í•˜ê³ 
      // ìœ ì €ì™€ ê°’ì´ ë§žì•„ ë–¨ì–´ì§„ë‹¤ë©´? ê°’ì´ ìžˆë‹¤ë©´?? elseë¬¸ì„ ì‹¤í–‰
      db.query(sOrders, [userId, totalPrice], (err, result) => {
        if(err) throw err;
        else {
          // ì˜¤ë¥˜ê°€ ì•„ë‹ê²½ìš°ì—
          // ordersë¥¼ ë§µí•‘í•´ì„œ
          // ì£¼ë¬¸ idê°’ê³¼, ì œí’ˆ idê°’, ìˆ˜ëŸ‰ì„ ë‹´ì•„ë‘”ë‹¤.
          // ê·¸í›„ ì¿¼ë¦¬ë¬¸ì„ ëŒë ¤ì„œ postìš”ì²­ì´ ì˜¨ value ë¥¼ ë§µí•‘ì„ í†µí•´ ì–»ì–´ë‚¸ valueë¡œ ì¹˜í™˜í•œë‹¤.
          // ê·¸ë¦¬ê³  ì½œë°± 
          let sOrders2 = `INSERT INTO order_items(order_id,item_id,order_quantity) VALUES ?`
          console.log(orders)
          let values = orders.map((order) => //ordersëŠ” reduxì—ì„œ initialStateë¡œ ë“¤ì–´ì˜¤ëŠ” ê°ì²´ í˜•ì‹ì˜ ê°’.
          // result.inserId ëŠ” INSERT ë¬¸ì´ ì‹¤í–‰ëì„ ë•Œ, ì‚½ìž…ëœ ë°ì´í„°ì˜ idë¥¼ ì–»ëŠ” ë°©ë²•
          [result.insertId, order.itemId, order.quantity]
          )
          db.query(sOrders2, [values], (err, result) => {
            console.log(result)
            callback(err, result);
          })
        }
      })
    }
  },
  ```