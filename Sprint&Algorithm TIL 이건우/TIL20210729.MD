# TIL 2021 - 07 - 29 ğŸ“– !
ì˜¤ëŠ˜ì€ ìŠ¤í”„ë¦°íŠ¸ shortlyì˜ ì–´ë“œë²¤ìŠ¤ë“œì¸ associate ê´€ê³„ì„¤ì •ì„ í•´ë³´ì•˜ìŠµë‹ˆë‹¤ .

ìš°ì„  user ë¼ëŠ” ëª¨ë¸ì„ ìƒì„±í•©ë‹ˆë‹¤ 

```
npx sequelize-cli model:generate --name User --attributes firstName:string,lastName:string,email:string
```
ì´ë ‡ê²Œ ì‘ì„± í•´ì£¼ë©´ user.js íŒŒì¼ê³¼ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ì´ ìƒì„± ë©ë‹ˆë‹¤ .
ê·¸ëŸ¬ë©´ ë§ˆì´ê·¸ë ˆì´íŠ¸ë¥¼ í•´ì¤ë‹ˆë‹¤ .
```
npx sequelize-cli db:migrate
```
ê·¸ ë’¤ì— 
```
$ npx sequelize migration:generate --name add-use-userId-column
```
migration generateë¡œ userId ë¼ëŠ” ì»¬ëŸ¼ì„ ìƒì„±í•´ ì£¼ê³  ë‹¤ì‹œ migrate í•´ì£¼ë©´ ìƒˆë¡œìš´ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ì´ ìƒì„± ë˜ëŠ”ë° FKë¥¼ ê±°ê¸°ì„œ ì§€ì •í•´ì£¼ë©´ ë©ë‹ˆë‹¤ .

```

module.exports = {
  up: async (queryInterface, Sequelize) => {
    //field ì¶”ê°€
    await queryInterface.addColumn('urls', 'userId', Sequelize.INTEGER);

        // foreign key ì—°ê²°
        await queryInterface.addConstraint('urls', {
          fields: ['userId'],//ë°°ì—´ë¡œ ê°ì‹¸ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤
          type: 'foreign key',
          name: 'FK_any_name_you_want',
          references: {
            table: 'users',
            field: 'id'
          },
          onDelete: 'cascade',
          onUpdate: 'cascade'
        });
  },

  down: async (queryInterface, Sequelize) => {
    await queryInterface.removeConstraint('urls', 'FK_any_name_you_want');
    await queryInterface.removeColumn('urls', 'userId');
  }
};
```

ì´ë ‡ê²Œ ë§Œë“¤ì–´ì¤€ ë’¤ì— index.js ì— 
```
const { url, user } = sequelize.models;
url.belongsTo(user);
user.hasMany(url);
``` ì´ë ‡ê²Œ í•´ì£¼ì–´ë„ ë˜ê³  

ê°ê° url.jsì™€ user.jsì— 
```
//url.jsì—ì„œ
    static associate(models) {
      models.url.belongsTo(models.User);
    }
//useer.jsì—ì„œ 
    static associate(models) {
      models.User.hasMany(models.url)
    }
```
ë¥¼ í•´ì£¼ë©´ ë©ë‹ˆë‹¤ !     