# TIL 2021 - 08 - 06  📖 !

- sprint

- 가비지 컬렉션에 대해 이해할 수 있다.
   - 가비지 컬렉션이란?
     
      메모리 관리 기법 중 하나로 프로그램이 동적으로 할당했던 메모리 영역 중에서 필요없게 된 영역을 해제하는 기능이다. 
      즉, 동적 할당된 메모리 영역 가운데 어떤 변수도 가리키지 않는 메모리 영역을 탐지하여 자동으로 해제하는 기법이다. 

    - 장점 
      - GC를 이용하게 되면 프로그래머가 동적으로 할당한 메모리 영역 전체를 완벽하게 관리하지 않아도 된다. 즉, GC를 통해 아래와 같은 버그를 줄이거나 막을 수 있다. 

      - 유효하지 않은 포인터 접근 : 이미 동적 할당한 메모리를 해제한 영역에 접근하게 되는 버그 

      - 이중 해제 : 이미 해제된 메모리를 또 다시 해제하는 오류를 줄일 수 있다. 대표적으로 C에서는 free()를 통해 해제하고 또 다시 free()를 하면 정상 종료 되지 않는다. 

      - 메모리 누수 : 더이상 사용하지 않는 메모리 영역을 해제하지 않고 남겨진 것이 쌓이게 되면 메모리 누수가 일어난다는 것이다. 이러한 메모리 누수가 지속되면 메모리 고갈로 인해 프로그램이 중단 될 수 있다. 

  - 단점 

     - 어떤 메모리를 해제해야 할 지 결정하는데 사용되는 알고리즘에 의해 비용이 든다. 객체가 필요없어지는 시점을 프로그래머가 알고 있는 경우에도 GC 알고리즘이 메모리 해제 시점을 추적해야하기에 비용이 들게된다. 

      - GC가 행동하는 타이밍이나 GC의 점유 시간을 사전에 예측하기 어렵기에 실시간 시스템에는 적합하지 않다. 

      - 할당된 메모리가 해제되는 시점을 알 수 없게 된다. 

  - 가비지 컬렉션의 위험성

     - 실시간 시스템에서 Garbage Collection이 사용된다면 치명적인 오류를 발생할 수 있다. 군사목적의 프로그래밍(미사일 발사 등) 혹은 비행시스템 등에서 실시간으로 목표물 지점으로 날아가고 있는 중간에 Garbage Collection이 발생하여 동작하게 되면 잠시 동안 앞에서 말한 알고리즘의 동작이 멈출 수 있는 가능성 때문에 실시간 시스템에서는 Garbage Collection은 지양해야 한다. 

 - GC 과정
     - GC의 과정을 Mark and Sweep이라고도 한다. GC가 스택의 모든 변수 또는 Reachable 객체를 스캔하면서 각각 어떤 객체를 참조하고 있는지 찾는 과정이 Mark라고 한다. 이 과정에서 Stop the world가 발생한다. 이후 Mark 되어있지 않은 객체들을 힙에서 제거하는 과정이 Sweep이다.

- 웹 서비스에서 사용하는 다양한 캐싱의 사례를 이해할 수 있다.

  - 캐싱이란 무엇인가?
     - 컴퓨팅에서 캐시는 일반적으로   일시적인 특징이 있는 데이터 하위 집합을 저장하는 고속 데이터 스토리지 계층입니다. 
     따라서 이후에 해당 데이터에 대한 요청이 있을 경우 데이터의 기본 스토리지 위치에 액세스할 때보다 더 빠르게 요청을 처리할 수 있습니다. 캐싱을 사용하면 이전에 검색하거나 계산한 데이터를 효율적으로 재사용할 수 있습니다.

      - 캐싱 기본 개념 : 캐싱(Caching)은 애플리케이션의 처리 속도를 높여준다. 이미 가져온 데이터나 계산된 결과값의 복사본을 저장함으로써 처리 속도를 향상시키며, 이를 통해 향후 요청을 더 빠르게 처리할 수 있다. 대부분의 프로그램이 동일한 데이터나 명령어에 반복해서 엑세스하기 때문에 캐싱은 효율적인 아키텍처 패턴이다.

     - 웹 캐시(WEB Cache) :  사용자(client)가 웹 사이트(server)에 접속할 때, 정적 컨텐츠(이미지, JS, CSS 등)를 특정 위치(client, network 등)에 저장하여, 웹 사이트 서버에 해당 컨텐츠를 매번 요청하여 받는것이 아니라, 특정 위치에서 불러옴으로써 사이트 응답시간을 줄이고, 서버 트래픽 감소 효과를 볼 수 있다

  - 웹 캐쉬의 종류
 
     - 웹 캐쉬의 종류는 어디에 적용하느냐에 따라 다음과 같이 나뉠 수 있으며 이중 중점적으로 볼 내용은 Browser Cache입니다.

 

      1. Browser Caches
         - 브라우저 또는 HTTP요청을 하는 Client Application에 의해 내부 디스크에 캐쉬

         - Cache된 Resource를 공유하지 않는 한 개인에 한정된 Cache

          - 브라우저의 Back버튼 또는 이미 방문한 페이지를 재 방문하는 경우 극대화

 

      2. Proxy Caches

         - Browser Cache와 동일한 원리로 동작하며 Client나 Server가아닌 네트워크 상에서 동작.

         - 큰회사나 IPS의 방화벽에 설치 되며 대기시간 & 트래픽 감소, 접근정책 & 제한 우회, 사용률 기록등 수행

          - 한정된 수의 클라이언트을 위하여 무한대의 웹서버의 컨텐츠를 캐쉬

  

     3. Gateway Caches (REVERSE OR SURROGATE PROXY)

         - 서버 앞 단에 설치되어 요청에 대한 캐쉬 및 효율적인 분배를 통해 가용성, 신뢰성, 성능등을 향상

          - Encryption / SSL acceleration, Load balancing, Serve/cache static content, Compression등을 수행

           - 무한대의 클라이언트들에게 한정된 수(또는 하나)의 웹서버 컨텐츠를 제공

 






  - 캐싱은 어떻게 작동할까요?
       - 캐시의 데이터는 일반적으로 RAM(Random Access Memory)과 같이 빠르게 액세스할 수 있는 하드웨어에 저장되며, 소프트웨어 구성 요소와 함께 사용될 수도 있습니다. 캐시의 주요 목적은 더 느린 기본 스토리지 계층에 액세스해야 하는 필요를 줄임으로써 데이터 검색 성능을 높이는 것입니다.
       속도를 위해 용량을 절충하는 캐시는 일반적으로 데이터의 하위 집합을 일시적으로 저장합니다. 보통 완전하고 영구적인 데이터가 있는 데이터베이스와는 대조적입니다.
       어떻게 캐쉬가 동작 하나?

       - 첫 요청
          1. 브라우저는 서버에 index.html 파일을 요청합니다. 

          2. 서버는 index.html파일을 찾아보고 존재 하는 파일이라면 파일 내용을 브라우저에게 몇 가지 header값과 함께 응답합니다.

          3. 브라우저는 응답 받은 내용을 브라우저에 표시하고 응답 헤더의 내용에 따라 캐쉬 정책을 수행합니다.

             (응답 헤더에 Last-Modified, Etag, Expires, Cache-Control:max-age 항목이 존재 한다면 복사본을 생성하고 값을 저장






  - 프록시 서버?

요약하면 다음과 같습니다.

   1. PC와 외부인터넷 사이의 중개자 역할을 합니다.

   2. 외부 인터넷의 내부침입을 막는 방화벽역할도합니다.

   3. 프록시 서버는 캐시 기능을 가지고있습니다. 그래서 웹 캐싱서비스에서 프록시서버가 자주언급되고있습니다.


 - 프록시 서버 역할에대해 간단히 살펴보면 다음과 같습니다.

    -  프록시 서버는 클라이언트가 앞서 요청했던 웹페이지를 다시한번 요청하면, 프록시 서버는  캐싱 되었던 페이지를 즉각적으로 클라이언트에게 주기때문에 빠른 반응성을 가지게 됩니다. 

        프록시 서버는 대개 조직(회사) 네트워크에 사용됩니다. 집에서 인터넷을 사용할때는 프록시서버를 사용하지않습니다. 
 - 재 요청

   1. 브라우저는 최초 응답 시 받은 Last-Modified 값을 If-Modified-Since 라     는 헤더에 포함 시켜 페이지를 요청합니다.

    2. 서버는 요청 파일의 수정 시간을 If-Modified-Since값과 비교하여 동일하     다면 304 Not Modified로 응답하고 다르다면 200 OK와 함께 새로운           Last-Modified값을 응답 헤더에 전송합니다.

    3. 브라우저는 응답 코드가 304인경우 캐쉬에서 페이지를 로드하고 200이라     면 새로 다운받은후 Last-Modified값을 갱신합니다.

    - CACHING STRATEGY 

      캐쉬가 잘 적용되게 하기 위해서 다음과 같은 전략을 새웁니다.

      1. 일관된 URL을 사용하라. 동일한 URL은 동일한 사이트라면 다른 페이지에서도 캐쉬되어 사용될 수 있습니다.

      2. 자주 바뀌는 파일과 그렇지 않은 파일을 분리합니다. 그래야 각 Resource에 대해 최적의 freshness를 설정할 수 있습니다.

      3. 다운가능한 파일의 내용이 바뀌면 이름(URL)을 바꿉니다. 그래야 올바로 수정된 버전을 제공할 수 있습니다.

      4. SSL을 최소화 합니다. 암호화된 페이지는 캐쉬되지 않습니다


 

- 프록시 서버의 종류

   1. Caching Proxy Server
      클라이언트의 요청 내용과 응답 컨텐츠를 저장해 두었다가 동일한 요청이 들어오면 저장된 컨텐츠를 전송합니다.

   2. Web Proxy
      WWW 트래픽에 초점이 맞춰진 프록시 서버입니다. 웹 프록시의 가장 일반적 형태는 웹 캐시입니다.

   3. Forward Proxy
    일반적으로 사용하는 프록시입니다. 클라이언트와 웹서버 사이에 위치하여 클라이언트가 타켓인 서버에 서비스 요청을하면,
    프록시 서버로 요청이 갑니다. 그러면 프록시 서버가 해당 서비스 서버 타켓으로 요청을 중계합니다.

